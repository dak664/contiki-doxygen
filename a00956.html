<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Contiki 2.5: cpu/stm32w108/dev/stm32w-radio.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_2bb2cfd8296a7c3e25e97aa2e3d0a212.html">cpu</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e68658a80db834fb0d1d37b2918a44a9.html">stm32w108</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_9d82881ba765c58d55dda36565ac79b8.html">dev</a>
  </div>
</div>
<div class="contents">
<h1>stm32w-radio.c File Reference</h1>
<p>Machine dependent STM32W radio code.  
<a href="#_details">More...</a></p>
<code>#include &quot;hal/error.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00762_source.html">hal/hal.h</a>&quot;</code><br/>
<code>#include &quot;contiki.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00263_source.html">net/mac/frame802154.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00957_source.html">dev/stm32w-radio.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00296_source.html">net/netstack.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00298_source.html">net/packetbuf.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00353_source.html">net/rime/rimestats.h</a>&quot;</code><br/>
<code>#include &quot;dev/leds.h&quot;</code><br/>

<p><a href="a00956_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00956.html#abedbf2302418c28e1b4b56e4e88ab4d6">ST_RadioReceiveIsrCallback</a> (u8 *packet, <a class="el" href="a01703.html#ga7670a4e8a07d9ebb00411948b0bbf86d">boolean</a> ackFramePendingSet, u32 time, u16 errors, s8 rssi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called by the library when a packet has been received.  <a href="#abedbf2302418c28e1b4b56e4e88ab4d6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00956.html#aaa7624411c930f9bee3bc136d2e2fd1f">ST_RadioTransmitCompleteIsrCallback</a> (StStatus status, u32 txSyncTime, <a class="el" href="a01703.html#ga7670a4e8a07d9ebb00411948b0bbf86d">boolean</a> framePending)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called by the library once after each ST_RadioTransmit() call that returned successfully.  <a href="#aaa7624411c930f9bee3bc136d2e2fd1f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="a01703.html#ga7670a4e8a07d9ebb00411948b0bbf86d">boolean</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00956.html#ac59ed377ba01bac2d1d668bead43952a">ST_RadioDataPendingShortIdIsrCallback</a> (int16u shortId)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called by the library after the short address fields of a packet have been received.  <a href="#ac59ed377ba01bac2d1d668bead43952a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="a01703.html#ga7670a4e8a07d9ebb00411948b0bbf86d">boolean</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00956.html#aa85360657e6243f3dc65b8a9652a9813">ST_RadioDataPendingLongIdIsrCallback</a> (int8u *longId)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called by the library after the long address fields of a packet have been received.  <a href="#aa85360657e6243f3dc65b8a9652a9813"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a81f4c1665dc7803bda9010b0ea3a6955"></a><!-- doxytag: member="stm32w&#45;radio.c::ST_RadioOverflowIsrCallback" ref="a81f4c1665dc7803bda9010b0ea3a6955" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00956.html#a81f4c1665dc7803bda9010b0ea3a6955">ST_RadioOverflowIsrCallback</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called by the library in response to a receive overflow event if this notification is enabled by a call to ST_RadioEnableOverflowNotification(). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00956.html#a499a45a081962b224521f2924a5d2c97">ST_RadioSfdSentIsrCallback</a> (u32 sfdSentTime)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called by the library in response to an SFD sent event if this notification has been enabled by a call to <code>ST_RadioEnableSfdSentNotification()</code>.  <a href="#a499a45a081962b224521f2924a5d2c97"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a35f8ace4829f35a5690c7efb46e6edb8"></a><!-- doxytag: member="stm32w&#45;radio.c::ST_RadioMacTimerCompareIsrCallback" ref="a35f8ace4829f35a5690c7efb46e6edb8" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00956.html#a35f8ace4829f35a5690c7efb46e6edb8">ST_RadioMacTimerCompareIsrCallback</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called by the library in response to MAC <a class="el" href="a00086.html" title="A timer.">timer</a> comparison event. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Machine dependent STM32W radio code. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Salvatore Pitrulli </dd></dl>

<p>Definition in file <a class="el" href="a00956_source.html">stm32w-radio.c</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aa85360657e6243f3dc65b8a9652a9813"></a><!-- doxytag: member="stm32w&#45;radio.c::ST_RadioDataPendingLongIdIsrCallback" ref="aa85360657e6243f3dc65b8a9652a9813" args="(int8u *longId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a01703.html#ga7670a4e8a07d9ebb00411948b0bbf86d">boolean</a> ST_RadioDataPendingLongIdIsrCallback </td>
          <td>(</td>
          <td class="paramtype">u8 *&nbsp;</td>
          <td class="paramname"> <em>longId</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function is called by the library after the long address fields of a packet have been received. </p>
<p>The library will set the frame pending bit in the outgoing ACK only if the return value is TRUE. The application must lookup the <code>eui64</code> in its own data structures and return TRUE if there is data pending, FALSE otherwise. It is critical that this function complete as quickly as possible to ensure the frame pending bit can be set before the ACK is transmitted.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE if the frame pending bit should be set in the outgoing ACK. </dd></dl>

<p>Definition at line <a class="el" href="a00956_source.html#l00482">482</a> of file <a class="el" href="a00956_source.html">stm32w-radio.c</a>.</p>

<p>References <a class="el" href="a01022_source.html#l00175">FALSE</a>.</p>

</div>
</div>
<a class="anchor" id="ac59ed377ba01bac2d1d668bead43952a"></a><!-- doxytag: member="stm32w&#45;radio.c::ST_RadioDataPendingShortIdIsrCallback" ref="ac59ed377ba01bac2d1d668bead43952a" args="(int16u shortId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a01703.html#ga7670a4e8a07d9ebb00411948b0bbf86d">boolean</a> ST_RadioDataPendingShortIdIsrCallback </td>
          <td>(</td>
          <td class="paramtype">u16&nbsp;</td>
          <td class="paramname"> <em>shortId</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function is called by the library after the short address fields of a packet have been received. </p>
<p>The library will set the frame pending bit in the outgoing ACK only if the return value is TRUE. The application must lookup <code>shortId</code> in its own data structures and return TRUE if there is data pending, FALSE otherwise. It is critical that this function complete as quickly as possible to ensure the frame pending bit can be set before the ACK is transmitted.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE if the frame pending bit should be set in the outgoing ACK. </dd></dl>

<p>Definition at line <a class="el" href="a00956_source.html#l00477">477</a> of file <a class="el" href="a00956_source.html">stm32w-radio.c</a>.</p>

<p>References <a class="el" href="a01022_source.html#l00175">FALSE</a>.</p>

</div>
</div>
<a class="anchor" id="abedbf2302418c28e1b4b56e4e88ab4d6"></a><!-- doxytag: member="stm32w&#45;radio.c::ST_RadioReceiveIsrCallback" ref="abedbf2302418c28e1b4b56e4e88ab4d6" args="(u8 *packet, boolean ackFramePendingSet, u32 time, u16 errors, s8 rssi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ST_RadioReceiveIsrCallback </td>
          <td>(</td>
          <td class="paramtype">u8 *&nbsp;</td>
          <td class="paramname"> <em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a01703.html#ga7670a4e8a07d9ebb00411948b0bbf86d">boolean</a>&nbsp;</td>
          <td class="paramname"> <em>ackFramePendingSet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u16&nbsp;</td>
          <td class="paramname"> <em>errors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">s8&nbsp;</td>
          <td class="paramname"> <em>rssi</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function is called by the library when a packet has been received. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>*packet</em>&nbsp;</td><td>points to the packet data beginning with the length byte. The CRC bytes will have been removed from the packet.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ackFramePendingSet</em>&nbsp;</td><td>TRUE if the library set the Frame Pending bit in the hardware-generated MAC ACK to this packet, FALSE otherwise.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>time</em>&nbsp;</td><td>The value of the MAC <a class="el" href="a00086.html" title="A timer.">timer</a> when the SFD was received for this packet.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>errors</em>&nbsp;</td><td>The number of correlator errors in the packet.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rssi</em>&nbsp;</td><td>The energy detected over the last 8 symbols of the packet in units of dBm. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00956_source.html#l00402">402</a> of file <a class="el" href="a00956_source.html">stm32w-radio.c</a>.</p>

<p>References <a class="el" href="a01627.html#ga496ba132ce7a2ec12a8313dc05ab0142">process_poll()</a>.</p>

</div>
</div>
<a class="anchor" id="a499a45a081962b224521f2924a5d2c97"></a><!-- doxytag: member="stm32w&#45;radio.c::ST_RadioSfdSentIsrCallback" ref="a499a45a081962b224521f2924a5d2c97" args="(u32 sfdSentTime)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ST_RadioSfdSentIsrCallback </td>
          <td>(</td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>sfdSentTime</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function is called by the library in response to an SFD sent event if this notification has been enabled by a call to <code>ST_RadioEnableSfdSentNotification()</code>. </p>
<p>NOTE: This callback is called for ACKs as well as normal packets.</p>
<p>NOTE: In cases of extreme interrupt latency it is possible that <code>sfdSentTime</code> may contain the SFD time of the last received packet instead of the time of the last transmitted packet.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sfdSentTime</em>&nbsp;</td><td>the value of the MAC <a class="el" href="a00086.html" title="A timer.">timer</a> when the SFD was sent in the last transmitted packet. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00956_source.html#l00535">535</a> of file <a class="el" href="a00956_source.html">stm32w-radio.c</a>.</p>

</div>
</div>
<a class="anchor" id="aaa7624411c930f9bee3bc136d2e2fd1f"></a><!-- doxytag: member="stm32w&#45;radio.c::ST_RadioTransmitCompleteIsrCallback" ref="aaa7624411c930f9bee3bc136d2e2fd1f" args="(StStatus status, u32 txSyncTime, boolean framePending)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ST_RadioTransmitCompleteIsrCallback </td>
          <td>(</td>
          <td class="paramtype">StStatus&nbsp;</td>
          <td class="paramname"> <em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>sfdSentTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a01703.html#ga7670a4e8a07d9ebb00411948b0bbf86d">boolean</a>&nbsp;</td>
          <td class="paramname"> <em>framePending</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function is called by the library once after each ST_RadioTransmit() call that returned successfully. </p>
<p>If the ST_RadioTransmit() call returned an error <a class="el" href="a00956.html#aaa7624411c930f9bee3bc136d2e2fd1f" title="This function is called by the library once after each ST_RadioTransmit() call that...">ST_RadioTransmitCompleteIsrCallback()</a> will not be called.</p>
<p>NOTE: ST_RadioTransmit() can be called again within the context of this callback.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>parameter indicates one of the following conditions: ST_SUCCESS - the last byte of the non-ACK-request packet has been transmitted. ST_PHY_ACK_RECEIVED - the requested ACK was received. ST_MAC_NO_ACK_RECEIVED - the requested ACK was not received in time. ST_PHY_TX_CCA_FAIL - unable to transmit due to lack of clear channel on all attempts. ST_PHY_TX_UNDERFLOW - DMA underflow occurred while transmitting. Should never happen. ST_PHY_TX_INCOMPLETE - The PLL synthesizer failed to lock while transmitting. Should never happen.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sfdSentTime</em>&nbsp;</td><td>the value of the MAC <a class="el" href="a00086.html" title="A timer.">timer</a> captured when the SFD was sent.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>framePending</em>&nbsp;</td><td>TRUE if the received ACK indicates that data is pending for this node, FALSE otherwise. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00956_source.html#l00419">419</a> of file <a class="el" href="a00956_source.html">stm32w-radio.c</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Mon Apr 11 14:23:49 2011 for Contiki 2.5 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
